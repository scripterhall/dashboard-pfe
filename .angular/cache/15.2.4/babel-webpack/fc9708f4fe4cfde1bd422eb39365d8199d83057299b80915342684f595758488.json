{"ast":null,"code":"import { __values } from \"tslib\";\nimport { HistoireTicketService } from 'src/app/service/histoire-ticket.service';\nimport { ProductBacklogService } from 'src/app/service/product-backlog.service';\nimport { SprintService } from 'src/app/service/sprint.service';\nimport { Chart } from 'chart.js';\nimport { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/service/sprint.service\";\nimport * as i2 from \"src/app/service/histoire-ticket.service\";\nimport * as i3 from \"src/app/service/product-backlog.service\";\nimport * as i4 from \"@angular/common/http\";\nvar CourbesComponent = /** @class */function () {\n  function CourbesComponent(sprintService, ticketHistoireService, productBacklogService, http) {\n    this.sprintService = sprintService;\n    this.ticketHistoireService = ticketHistoireService;\n    this.productBacklogService = productBacklogService;\n    this.http = http;\n  }\n  CourbesComponent.prototype.ngOnInit = function () {\n    this.sprintId = 1; // Replace with your sprint ID\n    this.sprint = this.sprintService.getSprint(this.sprintId);\n    this.totalEstimation = this.calculateTotalEstimation();\n    this.dailyEstimation = this.calculateDailyEstimation();\n    this.dailyActual = this.calculateDailyActual();\n    this.createChart();\n  };\n  CourbesComponent.prototype.calculateTotalEstimation = function () {\n    var e_1, _a;\n    var totalEstimation = 0;\n    try {\n      for (var _b = __values(this.sprint.stories), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var story = _c.value;\n        totalEstimation += story.estimation;\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n    return totalEstimation;\n  };\n  CourbesComponent.prototype.calculateDailyEstimation = function () {\n    var sprintDuration = this.calculateSprintDuration();\n    var dailyEstimation = [];\n    for (var day = 1; day <= sprintDuration; day++) {\n      dailyEstimation.push(this.totalEstimation / sprintDuration);\n    }\n    return dailyEstimation;\n  };\n  CourbesComponent.prototype.calculateDailyActual = function () {\n    var e_2, _a;\n    var sprintDuration = this.calculateSprintDuration();\n    var dailyActual = [];\n    for (var day = 1; day <= sprintDuration; day++) {\n      var actualEffort = 0;\n      try {\n        for (var _b = (e_2 = void 0, __values(this.sprint.stories)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var story = _c.value;\n          if (story.state === 'done') {\n            actualEffort += story.effort;\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n      dailyActual.push(actualEffort);\n    }\n  };\n  CourbesComponent.prototype.calculateSprintDuration = function () {\n    var sprintStart = new Date(this.sprint.startDate);\n    var sprintEnd = new Date(this.sprint.endDate);\n    var oneDay = 24 * 60 * 60 * 1000; // Hours * Minutes * Seconds * Milliseconds\n    return Math.round(Math.abs((sprintEnd.getTime() - sprintStart.getTime()) / oneDay)) + 1;\n  };\n  CourbesComponent.prototype.createChart = function () {\n    var burnDownChart = new Chart('burnDownChart', {\n      type: 'line',\n      data: {\n        labels: this.generateLabels(),\n        datasets: [{\n          label: 'Effort Estimé',\n          data: this.dailyEstimation,\n          borderColor: 'blue',\n          fill: false\n        }, {\n          label: 'Effort Réel',\n          data: this.dailyActual,\n          borderColor: 'red',\n          fill: false\n        }]\n      }\n    });\n  };\n  CourbesComponent.prototype.generateLabels = function () {\n    var sprintDuration = this.calculateSprintDuration();\n    var labels = [];\n    for (var day = 1; day <= sprintDuration; day++) {\n      labels.push(Jour, $, {\n        day: day\n      });\n    }\n    return labels;\n  };\n  CourbesComponent.ɵfac = function CourbesComponent_Factory(t) {\n    return new (t || CourbesComponent)(i0.ɵɵdirectiveInject(i1.SprintService), i0.ɵɵdirectiveInject(i2.HistoireTicketService), i0.ɵɵdirectiveInject(i3.ProductBacklogService), i0.ɵɵdirectiveInject(i4.HttpClient));\n  };\n  CourbesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CourbesComponent,\n    selectors: [[\"app-courbes\"]],\n    decls: 2,\n    vars: 0,\n    consts: [[\"id\", \"burn-down-chart\", 1, \"courbe\"]],\n    template: function CourbesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\");\n        i0.ɵɵelement(1, \"canvas\", 0);\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\".courbe[_ngcontent-%COMP%] {\\n  position: relative;\\n  top: 50px;\\n  width: 800px;\\n}\"]\n  });\n  return CourbesComponent;\n}();\nexport { CourbesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}