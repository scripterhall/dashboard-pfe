{"ast":null,"code":"import { HistoireTicketService } from 'src/app/service/histoire-ticket.service';\nimport { ProductBacklogService } from 'src/app/service/product-backlog.service';\nimport { SprintService } from 'src/app/service/sprint.service';\nimport { Chart } from 'chart.js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/service/sprint.service\";\nimport * as i2 from \"src/app/service/product-backlog.service\";\nimport * as i3 from \"src/app/service/histoire-ticket.service\";\nvar CourbesComponent = /** @class */function () {\n  function CourbesComponent(sprintService, productBacklogservice, histoireTicketService) {\n    this.sprintService = sprintService;\n    this.productBacklogservice = productBacklogservice;\n    this.histoireTicketService = histoireTicketService;\n  }\n  CourbesComponent.prototype.ngOnInit = function () {\n    this.ctx = document.getElementById('myChart').getContext('2d');\n    var sprintData = [{\n      id: 1,\n      velocity: 23,\n      dateLancement: new Date(2023, 1, 1),\n      dateFin: new Date(2023, 1, 14)\n    }, {\n      id: 2,\n      velocity: 8,\n      dateLancement: new Date(2023, 1, 15),\n      dateFin: new Date(2023, 1, 28)\n    }, {\n      id: 3,\n      velocity: 13,\n      dateLancement: new Date(2023, 2, 2),\n      dateFin: new Date(2023, 2, 14)\n    }];\n    var ticketData = [{\n      id: 1,\n      idSprint: 1,\n      effort: 3,\n      dateDebut: new Date(2023, 1, 2),\n      dateFin: new Date(2023, 1, 5),\n      etat: 'done'\n    }, {\n      id: 2,\n      idSprint: 1,\n      effort: 5,\n      dateDebut: new Date(2023, 1, 3),\n      dateFin: new Date(2023, 1, 8),\n      etat: 'done'\n    }, {\n      id: 3,\n      idSprint: 1,\n      effort: 2,\n      dateDebut: new Date(2023, 1, 5),\n      dateFin: new Date(2023, 1, 7),\n      etat: 'done'\n    }, {\n      id: 4,\n      idSprint: 1,\n      effort: 13,\n      dateDebut: new Date(2023, 1, 17),\n      dateFin: new Date(2023, 1, 21),\n      etat: 'done'\n    }, {\n      id: 5,\n      idSprint: 2,\n      effort: 3,\n      dateDebut: new Date(2023, 1, 20),\n      dateFin: new Date(2023, 1, 22),\n      etat: 'done'\n    }, {\n      id: 6,\n      idSprint: 2,\n      effort: 5,\n      dateDebut: new Date(2023, 1, 22),\n      dateFin: new Date(2023, 1, 26),\n      etat: 'done'\n    }, {\n      id: 7,\n      idSprint: 3,\n      effort: 8,\n      dateDebut: new Date(2023, 2, 3),\n      dateFin: new Date(2023, 2, 7),\n      etat: 'done'\n    }, {\n      id: 9,\n      idSprint: 3,\n      effort: 5,\n      dateDebut: new Date(2023, 2, 7),\n      dateFin: new Date(2023, 2, 10),\n      etat: 'done'\n    }];\n    // Triez les sprints par date de fin\n    sprintData.sort(function (a, b) {\n      return a.dateFin.getTime() - b.dateFin.getTime();\n    });\n    // Déterminez la date de lancement du premier sprint\n    var startDate = sprintData[0].dateLancement;\n    // Initialisez les tableaux de données pour le graphique\n    var labels = [];\n    var effortTotalData = [];\n    // Initialisez l'effort total à 0 pour le premier sprint\n    var effortTotal = 0;\n    // Parcourez tous les sprints\n    sprintData.forEach(function (sprint) {\n      // Ajoutez l'étiquette pour la date de fin de sprint\n      labels.push(sprint.dateFin);\n      // Calculez l'effort total pour le sprint\n      var sprintEffortTotal = 0;\n      ticketData.filter(function (ticket) {\n        return ticket.idSprint === sprint.id && ticket.etat === 'done';\n      }).forEach(function (ticket) {\n        sprintEffortTotal += ticket.effort;\n      });\n      // Ajoutez l'effort total du sprint à l'effort total global\n      effortTotal += sprintEffortTotal;\n      // Ajoutez l'effort total global à la liste des données d'effort total\n      effortTotalData.push(effortTotal);\n    });\n    // Configurez le graphique\n    var data = {\n      labels: labels.map(function (label) {\n        return label.toLocaleDateString();\n      }),\n      datasets: [{\n        label: 'Effort total',\n        data: effortTotalData,\n        fill: 'start'\n      }]\n    };\n    var options = {\n      responsive: true,\n      interaction: {\n        mode: 'index',\n        intersect: false\n      },\n      plugins: {\n        title: {\n          display: true,\n          text: 'Burn-up chart'\n        },\n        tooltip: {\n          mode: 'index',\n          intersect: false\n        }\n      },\n      scales: {\n        x: {\n          title: {\n            display: true,\n            text: 'Date'\n          },\n          ticks: {\n            callback: function (value, index, values) {\n              // Affichez uniquement le jour, le mois et l'année pour les étiquettes de l'axe des x\n              var date = new Date(value);\n              return date.toLocaleDateString();\n            }\n          }\n        },\n        y: {\n          title: {\n            display: true,\n            text: 'Effort total'\n          },\n          min: 0\n        }\n      }\n    };\n    // Créez le graphique\n    var chart = new Chart(this.ctx, {\n      type: 'line',\n      data: data,\n      options: options\n    });\n    chart.update();\n  };\n  CourbesComponent.ɵfac = function CourbesComponent_Factory(t) {\n    return new (t || CourbesComponent)(i0.ɵɵdirectiveInject(i1.SprintService), i0.ɵɵdirectiveInject(i2.ProductBacklogService), i0.ɵɵdirectiveInject(i3.HistoireTicketService));\n  };\n  CourbesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CourbesComponent,\n    selectors: [[\"app-courbes\"]],\n    decls: 2,\n    vars: 0,\n    consts: [[1, \"chart-container\"], [\"id\", \"myChart\"]],\n    template: function CourbesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"canvas\", 1);\n        i0.ɵɵelementEnd();\n      }\n    }\n  });\n  return CourbesComponent;\n}();\nexport { CourbesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}